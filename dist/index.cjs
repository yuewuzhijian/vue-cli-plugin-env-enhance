"use strict";var e=require("node:path"),r=require("./utils.cjs");require("node:fs"),require("fs"),require("path"),require("os"),require("crypto");module.exports=function(s,t){const n=t.pluginOptions??{},i=n[r.pluginName]||n[function(e){const r=e.split("-");for(let e=1;e<r.length;e++){const s=r[e].at(0);s&&(r[e]=s.toUpperCase()+r[e].slice(1))}return r.join("")}(r.pluginName)],o=process.cwd(),c=i?.envDir||o,_=i?.envPrefix||["VUE_APP_","VITE_"],E=void 0===i?.useImportMetaEnv||Boolean(i.useImportMetaEnv);s.chainWebpack((t=>{t.plugin("define").tap((t=>{Object.assign(t[0],{__VUE_OPTIONS_API__:"true",__VUE_PROD_DEVTOOLS__:"false",__VUE_PROD_HYDRATION_MISMATCH_DETAILS__:"false"});const n=t[0]["process.env"],i=s.service.mode,O=n.NODE_ENV===JSON.stringify("production"),a=!O;if(e.resolve(c)!==o){const e=r.loadEnv(i,o,"",!1),s=r.loadEnv(i,c,"",!1);Object.keys(e).forEach((e=>{delete process.env[e]})),Object.entries(s).forEach((([e,r])=>{process.env[e]=r}))}const p=r.loadEnv(i,c,_);return Object.keys(n).forEach((e=>{["NODE_ENV","BASE_URL"].includes(e)||delete n[e]})),Object.assign(n,{MODE:JSON.stringify(i),PROD:JSON.stringify(O),DEV:JSON.stringify(a)}),Object.entries(p).forEach((([e,r])=>{n[e]=JSON.stringify(r)})),E&&(t[0]["import.meta.env"]=JSON.stringify({MODE:i,BASE_URL:JSON.parse(n.BASE_URL),PROD:O,DEV:a,...p})),t}))}))};
